# Story 3.1: Favorite Locations Management

**Epic:** Epic 3 - Favorites & Polish  
**Story ID:** 3.1  
**Created:** 2025-12-03  
**Status:** Draft  

---

## Story

As a **user**,  
I want **to save favorite locations for quick access**,  
so that **I can instantly check weather for places I care about without searching**.

---

## Acceptance Criteria

1. "Add to Favorites" button/icon displayed on weather display
2. Users can save current location to favorites list
3. Favorites stored in localStorage with location name and coordinates
4. Maximum of 10 favorite locations enforced
5. Favorites list component displays all saved locations
6. Each favorite shows location name and current temperature (mini preview)
7. Tapping a favorite loads full weather for that location
8. Swipe-to-delete gesture on mobile to remove favorites
9. Delete button on desktop for removing favorites
10. Favorites list accessible from navigation/header
11. Empty state displayed when no favorites exist with helpful prompt
12. Framer Motion animations for adding/removing favorites
13. Favorites list is draggable for reordering (optional enhancement)

---

## Tasks

### Task 1: Create Favorites Service
- Create `src/services/favorites/favoritesService.ts`
- Implement localStorage CRUD operations
- `addFavorite({ lat, lon, name, country })`
- `removeFavorite(id)`
- `getFavorites()`: returns array
- Enforce max 10 favorites
- Handle localStorage errors gracefully

### Task 2: Create Favorites Context
- Create React Context for favorites state
- Provide `favorites`, `addFavorite`, `removeFavorite` functions
- Sync context with localStorage
- Wrap app with FavoritesProvider

### Task 3: Add "Add to Favorites" Button
- Create heart icon button in WeatherDisplay
- Show filled heart if location is favorited
- Show outline heart if not favorited
- On click, toggle favorite status
- Animate button with Framer Motion (scale, heart beat)
- Show toast/notification on add/remove

### Task 4: Create FavoritesList Component
- Display grid or list of favorited locations
- Each item shows: name, country flag icon, mini temp preview
- Fetch current temp for each favorite (use existing hooks)
- Handle multiple simultaneous API calls efficiently
- Apply glassmorphism card styling

### Task 5: Implement Delete Functionality
- Add swipe-to-delete on mobile (drag left reveals delete button)
- Add delete icon button on desktop (visible on hover)
- Confirm deletion with modal or inline confirmation
- Animate removal with Framer Motion slide-out
- Update localStorage after deletion

### Task 6: Add Favorites to Navigation
- Create "Favorites" link in header/nav
- Display favorites count badge (e.g., "5")
- Route to `/favorites` page
- Ensure accessible on all screen sizes

### Task 7: Create Empty State
- Display when favorites array is empty
- Show helpful message: "No favorites yet. Add locations to quickly access weather."
- Include visual illustration or icon
- Add CTA button: "Explore Locations"

### Task 8: Optional: Drag to Reorder
- Use drag-and-drop library or Framer Motion drag
- Allow users to reorder favorites by dragging
- Persist order to localStorage
- Visual feedback during drag (lift effect)

### Task 9: Create Tests
- Test add/remove favorite functionality
- Test localStorage persistence
- Test max 10 favorites enforcement
- Test favorites list rendering
- Test delete gestures and animations
- Achieve 90%+ coverage

---

## Dev Notes

**LocalStorage Key:** `weather-favorites` with structure `[{ id, lat, lon, name, country, addedAt }]`

**Max Favorites:** 10 (configurable constant)

**Preview Temperature:** Use `useWeatherQuery` for each favorite, display loading state until fetched

**Swipe-to-Delete:** Use Framer Motion `drag` prop with `onDragEnd` threshold detection

---

## Testing

Test favorites CRUD operations, localStorage sync, UI interactions, animations, and edge cases (max favorites, duplicates).

**Coverage:** 90%+

---

## Change Log

| Date | Author | Change |
|------|--------|--------|
| 2025-12-03 | SM (Bob) | Story created from PRD Epic 3, Story 3.1 |

---

## Dev Agent Record

**Date Started:** _Pending_  
**Date Completed:** _Pending_  
**Agent:** _Pending_  

---

## QA Results

**Status:** _Pending_
